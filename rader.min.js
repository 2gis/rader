'use strict';(function(z,w){function M(f){function z(a){if(a)q(document).on("selectstart.rader",function(){return!1});else q(document).off("selectstart.rader")}function C(a){for(var c=-1/0,b=0,d=a.length;b<d;b++)c<a[b]&&(c=a[b]);return c}function A(a){for(var c=1/0,b=0,d=a.length;b<d;b++)c>a[b]&&(c=a[b]);return c}function D(a){100<a&&(a=100);0>a&&(a=0);return a}function n(a){E[a]===w&&(E[a]=D(100*((a-x)/N)));return E[a]}function t(a){F[a]===w&&(F[a]=a/100*N+x);return F[a]}function O(a){var c=l[0],
b=l[l.length-1];if(!l)return a;for(var d=0;h[d+1]&&!(a>=h[d]&&a<=h[d+1]);)d++;var e=h[d],G=h[d+1]||e,g=l[d],d=l[d+1]||g;0>=G-e&&(G=H,e=x);a="log"==f.scale?Math.exp((a-e)/(G-e)*(Math.log(d)-Math.log(g))+Math.log(g)):(a-e)/(G-e)*(d-g)+g;return a<c?c:a>b?b:a}function R(a){var c=h[0],b=h[h.length-1];if(!h)return a;for(var d=0;l[d+1]&&!(a>=l[d]&&a<=l[d+1]);)d++;d==l.length-1&&d--;var e=l[d],g=l[d+1],k=h[d],d=h[d+1];a="log"==f.scale?(Math.log(a)-Math.log(e))/(Math.log(g)-Math.log(e))*(d-k)+k:(a-e)/(g-e)*
(d-k)+k;return a<c?c:a>b?b:a}function S(a){for(var c=a,b,d,e=9999,f=0;f<h.length;f++)d=n(h[f]),b=Math.abs(d-a),b<e&&(c=d,e=b);return c}function T(a,c){var b,d,e,g=1/0,k=a;b=S(a);var l=100*f.stickingRadius/u;e=Math.abs(b-a);if(e>l)return a;for(var m=0;m<h.length;m++)b=n(h[m]),d=Math.abs(b-a),b*c>a*c&&d<g&&(g=d,k=b);if(g<l)return k;if(g>=l)return a=D(a-e*c+l*c),Math.abs(k-a)<l?k:a}function I(a,c,b){var d;d=e[a]||0;if(b>d)d=1;else if(b<d)d=-1;else return!1;b=D(b);a!=c&&(b=T(b,d));var g=S(b),h=100*f.stickingRadius/
u;g!==w&&g!==b&&Math.abs(g-b)<h&&(!P&&f.transCls&&(m(J).addClass(f.transCls),P=setTimeout(function(){m(J).removeClass(f.transCls);P=w},500)),b=g);g=100*f.bumpRadius/u;e[c+1*d]!==w&&(e[c+1*d]-b<g&&0<d||b-e[c+1*d]<g&&0>d)&&(a=I(a,c+1*d,b+d*g),b*d>(a-g*d)*d&&(b=T(a-g*d,-d)));e[c]=b;a={};a[p.start]=e[c]+"%";m(B[c]).css(a);return b}function K(a){if(f.pointInRangeCls){var c=y.slice(),b;for(b=0;b<L.length;b++)n(h[b])>=e[0]&&n(h[b])<=e[e.length-1]?y[b]=1:y[b]=0;for(b=0;b<y.length;b++)if(y[b]!=c[b]||a)y[b]?
m(L[b]).addClass(f.pointInRangeCls):m(L[b]).removeClass(f.pointInRangeCls)}a={};a[p.start]=A(e)+"%";a[p.size]=C(e)-A(e)+"%";m(U).css(a);if(f.onUpdate)f.onUpdate({minPos:A(e),maxPos:C(e),minVal:t(A(e)),maxVal:t(C(e))})}function V(a,c){if(a){for(var b=(a.clientX-W)*(100/u),b=n(g[r])+b,d=0;d<e.length;d++)Q[d]=e[d];I(r,r,D(b))}a:if(e.length!=Q.length)b=!1;else{for(b=0;b<e.length;b++)if(e[b]!==Q[b]){b=!1;break a}b=!0}b&&!c||K(c)}function X(){var a=A(e),c=C(e),b=O(t(a)),d=O(t(c));f.collapseVals&&c-a<100*
f.bumpRadius/u+1E-5&&(100==c?b=d:0==a?d=b:e[r]===a?d=b:b=d);return{minPos:a,maxPos:c,minVal:b,maxVal:d}}function Y(){f.move&&f.move(X())}function Z(){u=J[p.a];E=[];F=[];var a,c;for(c=0;c<h.length;c++)a={},a[p.start]=n(h[c])+"%",m(L[c]).css(a);for(c=0;c<g.length;c++)a={},e[c]=n(g[c]),a[p.start]=e[c]+"%",m(B[c]).css(a);c=n(g[0]);var b=n(g[g.length-1]);a={};a[p.start]=c+"%";a[p.size]=Math.abs(b-c)+"%";m(U).css(a)}var M=this,N,u,p={start:"left",a:"clientWidth",offset:"offsetWidth",size:"width"},k,m,W,
r=-1,g=[],e=[],Q=[],y=[];this.elements={};m=f.dom||q;var J=f.root[0],U=f.trackActive,L=f.points,B=f.runners;k={stickingRadius:0,bumpRadius:B[0][p.offset],points:[],pointsPos:[0,10],runnersPos:[]};for(var v in k)f[v]===w&&(f[v]=k[v]);var h=f.pointsPos,s=f.runnersPos;v=f.runnersVal;var x=f.start,H=f.end,l=f.values,x=h[0],H=h[h.length-1];l||(l=h);if(v&&!s.length)for(k=0;k<v.length;k++)s[k]=R(v[k]);s.length||(s=[x,H]);N=Math.abs(H-x);var E=[],F=[],P;q(document).on("mouseup.rader blur.rader",function(){if(-1!=
r){for(var a=0,c=g.length;a<c;a++)g[a]=t(e[a]);f.change&&f.change(X());z(1)}r=-1});q(document).on("mousedown.rader",function(a){W=a.clientX});q(document).on("mousemove.rader",function(a){-1!=r&&(V(a,0),Y())});this.pos=function(a,c){if(null!=c){var b=n(c);I(a,a,b);for(b=0;b<e.length;b++)g[b]=t(e[b]);K(1)}return g[a]};this.val=function(a,c){if(null!=c){var b=R(c),b=n(b);I(a,a,b);for(b=0;b<e.length;b++)g[b]=t(e[b]);K(1)}return O(g[a])};this.invalidate=function(){Z();K(1);Y()};this.dispose=function(){q(document).off("rader");
q(B).off("rader")};for(k=0;k<s.length;k++)q(B[k]).on("mousedown.rader",function(a){return function(c){2!=c.button&&(c.preventDefault(),z(),r=a)}}(k));(function(){u=J[p.a];g=s.slice();for(var a=0;a<s.length;a++)e[a]=a;e[a-1]=100;for(a=0;a<s.length;a++)M.pos(a,g[a]),e[a]=n(g[a])})();Z();V(0,1);return this}var q=z.$;z.$.fn.rader=function(f){f=f||{};f.root=f.root||this;return new M(f)}})(window);
