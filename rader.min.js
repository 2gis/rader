'use strict';(function(B,x){function $(f){function B(a){if(a)q(document).on("selectstart.rader",function(){return!1});else q(document).off("selectstart.rader")}function E(a){for(var d=-1/0,b=0,c=a.length;b<c;b++)d<a[b]&&(d=a[b]);return d}function C(a){for(var d=1/0,b=0,c=a.length;b<c;b++)d>a[b]&&(d=a[b]);return d}function F(a){100<a&&(a=100);0>a&&(a=0);return a}function n(a){G[a]===x&&(G[a]=F(100*((a-y)/M)));return G[a]}function t(a){H[a]===x&&(H[a]=a/100*M+y);return H[a]}function N(a){var d=k[0],
b=k[k.length-1];if(!k)return a;for(var c=0;g[c+1]&&!(a>=g[c]&&a<=g[c+1]);)c++;var e=g[c],u=g[c+1]||e,m=k[c],c=k[c+1]||m;0>=u-e&&(u=I,e=y);a="log"==f.scale?Math.exp((a-e)/(u-e)*(Math.log(c)-Math.log(m))+Math.log(m)):(a-e)/(u-e)*(c-m)+m;return a<d?d:a>b?b:a}function R(a){var d=g[0],b=g[g.length-1];if(!g)return a;for(var c=0;k[c+1]&&!(a>=k[c]&&a<=k[c+1]);)c++;c==k.length-1&&c--;var e=k[c],u=k[c+1],m=g[c],c=g[c+1];a="log"==f.scale?(Math.log(a)-Math.log(e))/(Math.log(u)-Math.log(e))*(c-m)+m:(a-e)/(u-e)*
(c-m)+m;return a<d?d:a>b?b:a}function S(a){for(var d=a,b,c,e=9999,f=0;f<g.length;f++)c=n(g[f]),b=Math.abs(c-a),b<e&&(d=c,e=b);return d}function T(a,d){var b,c,e,k=1/0,m=a;b=S(a);var h=100*f.stickingRadius/z;e=Math.abs(b-a);if(e>h)return a;for(var l=0;l<g.length;l++)b=n(g[l]),c=Math.abs(b-a),b*d>a*d&&c<k&&(k=c,m=b);if(k<h)return m;if(k>=h)return a=F(a-e*d+h*d),Math.abs(m-a)<h?m:a}function J(a,d,b){var c;if(b>e[a])c=1;else if(b<e[a])c=-1;else return!1;b=F(b);a!=d&&(b=T(b,c));var g=S(b),h=100*f.stickingRadius/
z;g!==x&&g!==b&&Math.abs(g-b)<h&&(!O&&f.transCls&&(p(P).addClass(f.transCls),O=setTimeout(function(){p(P).removeClass(f.transCls);O=x},500)),b=g);g=100*f.bumpRadius/z;e[d+1*c]!==x&&(e[d+1*c]-b<g&&0<c||b-e[d+1*c]<g&&0>c)&&(a=J(a,d+1*c,b+c*g),b*c>(a-g*c)*c&&(b=T(a-g*c,-c)));e[d]=b;c={};c[r.start]=e[d]+"%";p(D[d]).css(c);return b}function K(a){if(f.pointInRangeCls){var d=A.slice(),b;for(b=0;b<L.length;b++)n(g[b])>=e[0]&&n(g[b])<=e[e.length-1]?A[b]=1:A[b]=0;for(b=0;b<A.length;b++)if(A[b]!=d[b]||a)A[b]?
p(L[b]).addClass(f.pointInRangeCls):p(L[b]).removeClass(f.pointInRangeCls)}a={};a[r.start]=C(e)+"%";a[r.size]=E(e)-C(e)+"%";p(U).css(a);if(f.onUpdate)f.onUpdate({d:C(e),b:E(e),e:t(C(e)),c:t(E(e))})}function V(a,d){if(a){for(var b=(a.clientX-W)*(100/z),b=n(h[s])+b,c=0;c<e.length;c++)Q[c]=e[c];J(s,s,F(b))}a:if(e.length!=Q.length)b=!1;else{for(b=0;b<e.length;b++)if(e[b]!==Q[b]){b=!1;break a}b=!0}b&&!d||K(d)}function X(){var a=C(e),d=E(e),b=N(t(a)),c=N(t(d));f.collapseVals&&d-a<100*f.bumpRadius/z+1E-5&&
(100==d?b=c:0==a?c=b:e[s]===a?c=b:b=c);return{minPos:a,maxPos:d,minVal:b,maxVal:c}}function Y(){f.move&&f.move(X())}function Z(){z=P[r.a];G=[];H=[];var a,d;for(d=0;d<g.length;d++)a={},a[r.start]=n(g[d])+"%",p(L[d]).css(a);for(d=0;d<h.length;d++)a={},e[d]=n(h[d]),a[r.start]=e[d]+"%",p(D[d]).css(a);d=n(h[0]);var b=n(h[h.length-1]);a={};a[r.start]=d+"%";a[r.size]=Math.abs(b-d)+"%";p(U).css(a)}var M,z,r={start:"left",a:"clientWidth",offset:"offsetWidth",size:"width"},l,p,W,s=-1,h=[],e=[],Q=[],A=[];this.elements=
{};p=f.dom||q;var P=f.root[0],U=f.trackActive,L=f.points,D=f.runners;l={stickingRadius:0,bumpRadius:D[0][r.offset],points:[],pointsPos:[0,10],runnersPos:[]};for(var v in l)f[v]===x&&(f[v]=l[v]);var g=f.pointsPos,w=f.runnersPos;v=f.runnersVal;var y=f.start,I=f.end,k=f.values,y=g[0],I=g[g.length-1];k||(k=g);if(v&&!w.length)for(l=0;l<v.length;l++)w[l]=R(v[l]);w.length||(w=[y,I]);M=Math.abs(I-y);var G=[],H=[],O;for(l=0;l<w.length;l++)q(D[l]).on("mousedown.rader",function(a){return function(d){2!=d.button&&
(d.preventDefault(),B(),s=a)}}(l));(function(){h=w.slice();for(var a=0;a<w.length;a++)e[a]=n(h[a])})();Z();V(0,1);q(document).on("mouseup.rader blur.rader",function(){if(-1!=s){for(var a=0,d=h.length;a<d;a++)h[a]=t(e[a]);f.change&&f.change(X());B(1)}s=-1});q(document).on("mousedown.rader",function(a){W=a.clientX});q(document).on("mousemove.rader",function(a){-1!=s&&(V(a,0),Y())});this.setPosition=function(a,d){var b=n(d);J(a,a,b);for(b=0;b<e.length;b++)h[b]=t(e[b]);K(1)};this.setValue=function(a,
d){var b=R(d),b=n(b);J(a,a,b);for(b=0;b<e.length;b++)h[b]=t(e[b]);K(1)};this.getPosition=function(a){return h[a]};this.getValue=function(a){return N(h[a])};this.invalidate=function(){Z();K(1);Y()};this.dispose=function(){q(document).off("rader");q(D).off("rader")};return this}var q=B.$;B.$.fn.rader=function(f){f=f||{};f.root=f.root||this;return new $(f)}})(window);
